# Example: Using signing keys with runtime configurations
#
# This example demonstrates how to:
# 1. Define a local mapping of signing keys (name -> key ID or global name)
# 2. Reference those keys in runtime configurations
#
# The signing_keys section acts as a bridge between friendly names
# and the actual key IDs from the global signing keys registry.
#
# Key IDs are the full SHA-256 hash of the public key, base16/hex encoded (64 characters).
# When you create a key with `avocado signing-keys create`, the key ID is also used
# as the default name if you don't provide a --name argument.

default_target: qemux86-64

sdk:
  image: docker.io/avocadolinux/avocado-sdk:apollo-edge

# Define signing keys with friendly names
# The values (right side) can be either:
# - A key ID: full 64-character hex-encoded SHA-256 hash of the public key
# - A global registry name: the name used when creating the key with `avocado signing-keys create --name <name>`
#
# Example with key IDs:
signing_keys:
  - production-key: abc123def456abc123def456abc123def456abc123def456abc123def456abc1
  - staging-key: 789012fedcba789012fedcba789012fedcba789012fedcba789012fedcba7890
  - backup-key: 111222333444111222333444111222333444111222333444111222333444dead

# You can also reference keys by their global registry name:
# signing_keys:
#   - production-key: my-production-signing-key  # name from global registry
#   - staging-key: my-staging-key                # will be resolved to key ID

runtime:
  # Production runtime uses the production signing key with blake3
  production:
    dependencies:
      avocado-runtime: "*"
    signing:
      key: production-key
      checksum_algorithm: blake3  # Use blake3 for faster checksums

  # Staging runtime uses a different key with sha256 (default)
  staging:
    dependencies:
      avocado-runtime: "*"
    signing:
      key: staging-key
      # checksum_algorithm defaults to sha256 if not specified

  # Development runtime with no signing
  dev:
    dependencies:
      avocado-runtime: "*"
    # No signing configuration - unsigned builds

# avocado build
# avocado runtime build -r dev
